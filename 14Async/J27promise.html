<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>J27promise.html</title>
</head>
<body>
  <h2>promise</h2>
  <!-- script type="text/javascript" 
  써도 되고 안써도 됨 대신 썼을 경우 예전에는 꼭 썼어야했어서
  예전 코드들과 호환성이 좋다.-->
  <!-- 프라미스는 비동기 작업의 완료 여부와 결과를 표현하는 객체로
  복잡한 비동기 흐름을 보다 선형적이고 직관적인 구조로 작성할 수 있게 해준다.
  프라미스는 다음 세가지 상태를 가진다.
  1. 대기 (pending) :요청 후 결과가 결정되지 않은 상태
  2. 이행 (fulfilled) : 작업이 성공적으로 완료된 상태 (resolve())
  3. 거부 (rejected) : 작업이 실패한 상태 (reject())    -->
  <script>
    /* 첫번째 프라미스 객체 생성
    내부의 콜백함수에는 매개변수 
    resolve() 와 reject() 이 자동으로 전달된다.
    각각 비동기 작업이 성공, 실패 했을 때 호출된다. */
    const myPromise1 = new Promise((resolve,reject) => {
      // 요청한 작업의 성공 여부 설정
      const success = true; // or false
      if(success){
        // 작업이 성공하면 resolve 를 호출
        resolve("작업 성공");
      }
      else{
        // 작업이 실패하면 reject 를 호출
        reject("작업 실패");
      }
    });
    // 첫번째 프라미스를 실행하기 위한 함수
    const func1 = () => {
      myPromise1
        .then((result) => {
          /* 프라미스가 요청한 작업에 성공하면 resolve 함수고 
          호출되고 그 결과는 then 절로 반환된다. */
          console.log(result);
        })
        .catch((error) => {
          /* 요청에 실패하면 reject 함수가 호출되고
          그 결과는 catch 절로 반환된다. */
          console.log(error);
        });
    }
    /* 두번째 프라미스 객체는 타이머 함수를 사용해서 
    3초후 작업이 완료되는 형태로 정의되어있다. */
    function myPromise2() {
      return new Promise((resolve) => {
        setTimeout(() => {
          resolve("3초 후 완료된 작업");
        }, 3000);
      });
    }
    /* 실제 서버와 통신할 때 발생되는 
    응답지연(Delay)과 유사하게 표현한 것으로 
    지연되는 시간만큼 대기 후 
    콜백 받은 데이터를 출력한다. */
    const func2 = () => {
      myPromise2().then(result => {
        console.log(result);
      });
    }
  </script>
  <div>
    <button type="button" onclick="func1();">버튼1</button>
    <button type="button" onclick="func2();">버튼2</button>
  </div>

</body>
</html>